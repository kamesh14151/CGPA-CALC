<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B.E. AIML GPA & CGPA Calculator | AJ STUDIOS</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6a11cb;
            --primary-dark: #4d0b9c;
            --secondary: #2575fc;
            --secondary-dark: #1a5fd3;
            --success: #00b09b;
            --danger: #ff416c;
            --warning: #ffb347;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --card-bg: rgba(255, 255, 255, 0.08);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: "Poppins", sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        h1, h2, h3 {
            font-weight: 600;
            margin: 10px 0;
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #fff, #c9d6ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        h2 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--text-secondary);
            position: relative;
            display: inline-block;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 3px;
        }

        .container {
            max-width: 1200px;
            margin: 30px auto;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .container:hover {
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            transform: translateY(-2px);
        }

        /* Header with logo */
        .header {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            gap: 15px;
            text-align: center;
        }

        .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .logo {
            width: 70px;
            height: 70px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .logo:hover {
            transform: rotate(10deg) scale(1.05);
        }

        .logo i {
            font-size: 2rem;
            color: white;
        }

        .brand-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-secondary);
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-top: 5px;
        }

        .brand-tagline {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 5px;
        }

        /* Form elements */
        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--text-secondary);
            font-size: 1rem;
        }

        select, input {
            width: 100%;
            padding: 14px 18px;
            border-radius: 12px;
            border: none;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.9);
            color: #2c3e50;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            appearance: none;
            -webkit-appearance: none;
        }

        select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%232c3e50' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 12px;
        }

        select:focus, input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.3);
            transform: translateY(-2px);
        }

        button {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            font-weight: 600;
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            font-size: 16px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            letter-spacing: 0.5px;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, var(--primary-dark), var(--secondary-dark));
        }

        button:active {
            transform: translateY(1px);
        }

        /* Subject cards */
        .subject-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .subject-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            border-left: 5px solid var(--primary);
            position: relative;
            overflow: hidden;
        }

        .subject-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(106, 17, 203, 0.1), rgba(37, 117, 252, 0.1));
            z-index: -1;
        }

        .subject-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
        }

        .subject-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .subject-code {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
            letter-spacing: 0.5px;
        }

        .subject-credits {
            background: rgba(0, 0, 0, 0.4);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
        }

        .subject-name {
            margin: 12px 0;
            font-size: 1.1rem;
            line-height: 1.5;
            color: var(--text-primary);
            min-height: 60px;
        }

        .subject-grade {
            margin-top: 15px;
        }

        .subject-grade select {
            width: 100%;
            padding: 10px 15px;
            font-size: 1rem;
            border-radius: 10px;
        }

        /* Result cards */
        .result-card {
            margin: 30px 0;
            padding: 25px;
            border-radius: 18px;
            text-align: center;
            font-size: 1.6rem;
            font-weight: 600;
            transition: all 0.5s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 120px;
            position: relative;
            overflow: hidden;
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
            z-index: -1;
        }

        .gpa-result {
            background: linear-gradient(135deg, rgba(106, 17, 203, 0.8), rgba(37, 117, 252, 0.8));
        }

        .cgpa-result {
            background: linear-gradient(135deg, rgba(0, 176, 155, 0.8), rgba(150, 201, 61, 0.8));
        }

        .fail {
            background: linear-gradient(135deg, rgba(255, 65, 108, 0.8), rgba(255, 75, 43, 0.8));
            animation: pulse 1.5s infinite;
        }

        .high {
            background: linear-gradient(135deg, rgba(0, 255, 153, 0.8), rgba(0, 204, 255, 0.8));
            box-shadow: 0 0 25px rgba(0, 255, 153, 0.6), 0 0 35px rgba(0, 204, 255, 0.6);
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 65, 108, 0.4); }
            70% { box-shadow: 0 0 0 20px rgba(255, 65, 108, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 65, 108, 0); }
        }

        .result-value {
            font-size: 3rem;
            font-weight: 700;
            margin: 15px 0;
            background: linear-gradient(90deg, #fff, #c9d6ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .result-label {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 5px;
        }

        /* Progress bar */
        .progress-container {
            width: 80%;
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 5px;
            transition: width 0.5s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        /* Arrears section */
        .arrears-container {
            margin-top: 30px;
            background: linear-gradient(135deg, rgba(255, 65, 108, 0.2), rgba(255, 75, 43, 0.2));
            padding: 20px;
            border-radius: 18px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transition: all 0.5s ease;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            border: 1px solid rgba(255, 65, 108, 0.3);
        }

        .arrears-container.show {
            max-height: 500px;
            opacity: 1;
            padding: 25px;
        }

        .arrears-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            margin-bottom: 15px;
        }

        .arrears-header h3 {
            margin: 0;
            color: #ffcccb;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.3rem;
        }

        .arrears-list {
            list-style-type: none;
        }

        .arrears-list li {
            padding: 12px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 3px solid #ff416c;
        }

        .arrears-list li:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .arrears-list li::before {
            content: "⚠️";
            margin-right: 12px;
            font-size: 1.2rem;
        }

        /* CGPA section */
        .cgpa-section {
            margin-top: 40px;
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .semester-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .semester-input {
            background: rgba(255, 255, 255, 0.05);
            padding: 18px;
            border-radius: 15px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .semester-input label {
            font-size: 1rem;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.8);
        }

        .semester-input .auto-fetch {
            position: absolute;
            top: 12px;
            right: 12px;
            font-size: 0.85rem;
            color: #4CAF50;
            display: flex;
            align-items: center;
            gap: 6px;
            background: rgba(76, 175, 80, 0.1);
            padding: 3px 8px;
            border-radius: 20px;
        }

        .semester-input .auto-fetch i {
            font-size: 0.9rem;
        }

        /* Grade colors */
        .grade-O { border-left-color: #4CAF50 !important; }
        .grade-Aplus { border-left-color: #8BC34A !important; }
        .grade-A { border-left-color: #CDDC39 !important; }
        .grade-Bplus { border-left-color: #FFC107 !important; }
        .grade-B { border-left-color: #FF9800 !important; }
        .grade-C { border-left-color: #FF5722 !important; }
        .grade-U { border-left-color: #F44336 !important; }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
        }

        .footer a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .footer a:hover {
            color: var(--secondary);
            text-decoration: underline;
        }

        /* Floating action button */
        .fab {
            position: fixed;
            bottom: 40px;
            right: 40px;
            width: 70px;
            height: 70px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
            border: none;
        }

        .fab:hover {
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
            background: linear-gradient(45deg, var(--primary-dark), var(--secondary-dark));
        }

        /* Confetti effect */
        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            background-color: #f00;
            opacity: 0;
            z-index: 999;
            animation: confetti-fall 5s ease-in-out;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Responsive adjustments */
        @media (max-width: 992px) {
            .container {
                padding: 25px;
                margin: 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            h2 {
                font-size: 1.6rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 15px;
                border-radius: 15px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            h2 {
                font-size: 1.4rem;
            }
            
            .subject-grid {
                grid-template-columns: 1fr;
            }
            
            .semester-inputs {
                grid-template-columns: 1fr;
            }
            
            .logo {
                width: 60px;
                height: 60px;
            }
            
            .fab {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
                bottom: 30px;
                right: 30px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
                margin: 10px;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            h2 {
                font-size: 1.2rem;
            }
            
            .result-value {
                font-size: 2.5rem;
            }
            
            .subject-card {
                padding: 15px;
            }
            
            .subject-name {
                font-size: 1rem;
            }
        }

        /* Tooltip for grade info */
        .grade-info {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .grade-info .tooltip {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            font-weight: normal;
        }

        .grade-info:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }

        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-container">
                <div class="logo">
                    <i class="fas fa-calculator"></i>
                </div>
                <div class="brand-name">AJ STUDIOS</div>
                <div class="brand-tagline">Precision in Academic Calculation</div>
            </div>
            <h1>B.E. AIML GPA & CGPA Calculator</h1>
            <h2>By AJ STUDIOS</h2>
        </div>

        <div class="form-group">
            <label for="semester"><i class="fas fa-graduation-cap"></i> Select Semester</label>
            <select id="semester" onchange="loadSubjects()">
                <option value="">-- Select Semester --</option>
                <option value="1">Semester 1</option>
                <option value="2">Semester 2</option>
                <option value="3">Semester 3</option>
                <option value="4">Semester 4</option>
                <option value="5">Semester 5</option>
                <option value="6">Semester 6</option>
                <option value="7">Semester 7</option>
                <option value="8">Semester 8</option>
            </select>
        </div>

        <div id="subjectForm"></div>

        <div id="gpaResult" class="result-card gpa-result" style="display: none;">
            <div class="result-label">Semester GPA</div>
            <div class="result-value" id="gpaValue">0.00</div>
            <div class="progress-container">
                <div class="progress-bar" id="gpaProgress"></div>
            </div>
        </div>

        <div id="arrears" class="arrears-container">
            <div class="arrears-header" onclick="toggleArrears()">
                <h3><i class="fas fa-exclamation-triangle"></i> Arrear Subjects</h3>
                <i class="fas fa-chevron-down"></i>
            </div>
            <ul class="arrears-list" id="arrearsList"></ul>
        </div>

        <div class="cgpa-section">
            <h2><i class="fas fa-chart-line"></i> CGPA Calculator</h2>
            
            <div id="cgpaContainer" class="semester-inputs"></div>
            
            <div id="cgpaResult" class="result-card cgpa-result">
                <div class="result-label">Overall CGPA</div>
                <div class="result-value" id="cgpaValue">0.00</div>
                <div class="progress-container">
                    <div class="progress-bar" id="cgpaProgress"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>© 2023 AJ STUDIOS | B.E. Artificial Intelligence and Machine Learning |</p>
            <p>Designed with <i class="fas fa-heart" style="color: #ff416c;"></i> AJ COMPANY for Sona College Students</p>
        </div>
    </div>

    <button class="fab" onclick="resetCalculator()" title="Reset Calculator">
        <i class="fas fa-redo"></i>
    </button>

    <script>
        const subjects = {
            1: [
                {code:"U23EG107", name:"Engineering Graphics", credits:4},
                {code:"U23ENG101A", name:"Communication Skills in English", credits:3},
                {code:"U23GE101", name:"Basic Aptitude - I", credits:1},
                {code:"U23MAT102A", name:"Linear Algebra and Calculus with MATLAB", credits:4},
                {code:"U23OL1103", name:"Japanese", credits:2},
                {code:"U23PHL110", name:"Engineering Physics Laboratory", credits:1},
                {code:"U23PHY103E", name:"Engineering Physics", credits:3},
                {code:"U23PPL112", name:"Python Programming Laboratory", credits:1},
                {code:"U23PPR105", name:"Problem Solving using Python Programming", credits:3},
                {code:"U23TAM101", name:"Heritage of Tamils", credits:2}
            ],
            2: [
                {code:"U23BEEE206B", name:"Basics of Electrical and Electronics Engineering", credits:3},
                {code:"U23BEEL213B", name:"BEEE Laboratory", credits:1},
                {code:"U23CHE204C", name:"Applied Chemistry", credits:3},
                {code:"U23CHL211", name:"Chemistry Laboratory", credits:1},
                {code:"U23CPL212", name:"C Programming Laboratory", credits:1},
                {code:"U23CPR205", name:"Programming in C", credits:3},
                {code:"U23EC203", name:"Digital Principles and System Design", credits:3},
                {code:"U23ENG201A", name:"Technical English", credits:3},
                {code:"U23GE201", name:"Basic Aptitude - II", credits:1},
                {code:"U23MAT202D", name:"Discrete Mathematics", credits:4},
                {code:"U23OL1203", name:"Japanese - II", credits:2},
                {code:"U23TAM201", name:"Tamils and Technology", credits:2}
            ],
            3: [
                {code:"U23MAT301E", name:"Applied Probability and Statistics-I", credits:4},
                {code:"U23CS301", name:"Data Structures", credits:3},
                {code:"U23CS302", name:"Computer Architecture", credits:3},
                {code:"U23CS303", name:"Object Oriented Programming Using Java", credits:3},
                {code:"U23AML301", name:"Data Visualization", credits:3},
                {code:"noc25-mg106", name:"NPTEL: Design Thinking - A Primer", credits:2},
                {code:"U23GE302", name:"Audit Course: Environment and Climate Science", credits:0},
                {code:"U23CS306", name:"Data Structures Laboratory", credits:1},
                {code:"U23CS307", name:"Object Oriented Programming Using Java Laboratory", credits:1},
                {code:"U23AML302", name:"Data Visualization Laboratory", credits:1},
                {code:"U23GE301", name:"Soft Skills and Aptitude-I", credits:1},
                {code:"Counseling", name:"Counseling", credits:0}
            ],
            4: [
                {code:"U23CS401", name:"Advanced Data Structures", credits:3},
                {code:"U23CS402", name:"Database Management Systems", credits:3},
                {code:"U23CS403", name:"Design and Analysis of Algorithms", credits:3},
                {code:"U23CS404", name:"Computer Networks", credits:3},
                {code:"U23CS405", name:"Artificial Intelligence", credits:3},
                {code:"U23CS406", name:"Software Engineering", credits:3},
                {code:"U23CS407", name:"Computer Graphics", credits:3},
                {code:"U23CS408", name:"Operating Systems", credits:3},
                {code:"U23CS409", name:"Discrete Mathematics", credits:3},
                {code:"U23CS410", name:"Elective I", credits:3}
            ],
            5: [
                {code:"U23CS501", name:"Machine Learning", credits:3},
                {code:"U23CS502", name:"Natural Language Processing", credits:3},
                {code:"U23CS503", name:"Deep Learning", credits:3},
                {code:"U23CS504", name:"Big Data Analytics", credits:3},
                {code:"U23CS505", name:"Cloud Computing", credits:3},
                {code:"U23CS506", name:"Data Mining", credits:3},
                {code:"U23CS507", name:"Internet of Things", credits:3},
                {code:"U23CS508", name:"Elective II", credits:3},
                {code:"U23CS509", name:"Project Work I", credits:3}
            ],
            6: [
                {code:"U23CS601", name:"Computer Vision", credits:3},
                {code:"U23CS602", name:"Reinforcement Learning", credits:3},
                {code:"U23CS603", name:"Robotics", credits:3},
                {code:"U23CS604", name:"Cyber Security", credits:3},
                {code:"U23CS605", name:"Blockchain Technology", credits:3},
                {code:"U23CS606", name:"Elective III", credits:3},
                {code:"U23CS607", name:"Project Work II", credits:3}
            ],
            7: [
                {code:"U23CS701", name:"Advanced Machine Learning", credits:3},
                {code:"U23CS702", name:"AI Ethics and Governance", credits:3},
                {code:"U23CS703", name:"Elective IV", credits:3},
                {code:"U23CS704", name:"Project Work III", credits:3}
            ],
            8: [
                {code:"U23CS801", name:"Industry Internship", credits:6},
                {code:"U23CS802", name:"Project Work IV", credits:6}
            ]
        };

        const gradePoints = {
            "O": 10, 
            "A+": 9, 
            "A": 8, 
            "B+": 7, 
            "B": 6, 
            "C": 5, 
            "U": 0
        };

        let selectedGrades = JSON.parse(localStorage.getItem("selectedGrades")) || {};
        let gpaPerSem = JSON.parse(localStorage.getItem("gpaPerSem")) || {};

        // Initialize the calculator
        function init() {
            loadCGPAInputs();
            const lastSem = localStorage.getItem("lastSemester");
            if (lastSem && subjects[lastSem]) {
                document.getElementById("semester").value = lastSem;
                loadSubjects();
            }
        }

        // Load subjects for selected semester
        function loadSubjects() {
            const sem = document.getElementById("semester").value;
            const form = document.getElementById("subjectForm");
            form.innerHTML = "";
            
            if (!sem || !subjects[sem]) return;
            
            localStorage.setItem("lastSemester", sem);
            
            if (!selectedGrades[sem]) {
                selectedGrades[sem] = Array(subjects[sem].length).fill("");
            }
            
            let html = `<div class="subject-grid">`;
            
            subjects[sem].forEach((sub, i) => {
                const savedGrade = selectedGrades[sem][i] || "";
                const gradeClass = savedGrade ? `grade-${savedGrade.replace('+', 'plus')}` : '';
                
                html += `
                    <div class="subject-card ${gradeClass}" id="card${i}">
                        <div class="subject-header">
                            <span class="subject-code">${sub.code}</span>
                            <span class="subject-credits">${sub.credits} Credits</span>
                        </div>
                        <div class="subject-name">${sub.name}</div>
                        <div class="subject-grade">
                            <select id="grade${i}" onchange="updateGPA(${sem}, ${i})" class="${gradeClass}">
                                <option value="">-- Select Grade --</option>
                                <option value="O" ${savedGrade === "O" ? "selected" : ""}>O (10)</option>
                                <option value="A+" ${savedGrade === "A+" ? "selected" : ""}>A+ (9)</option>
                                <option value="A" ${savedGrade === "A" ? "selected" : ""}>A (8)</option>
                                <option value="B+" ${savedGrade === "B+" ? "selected" : ""}>B+ (7)</option>
                                <option value="B" ${savedGrade === "B" ? "selected" : ""}>B (6)</option>
                                <option value="C" ${savedGrade === "C" ? "selected" : ""}>C (5)</option>
                                <option value="U" ${savedGrade === "U" ? "selected" : ""}>U (Fail)</option>
                            </select>
                        </div>
                    </div>`;
            });
            
            html += `</div>`;
            form.innerHTML = html;
        }

        // Update GPA calculation
        function updateGPA(sem, index) {
            if (!subjects[sem]) return;
            
            const gradeSelect = document.getElementById(`grade${index}`);
            const grade = gradeSelect ? gradeSelect.value : "";
            selectedGrades[sem][index] = grade;
            
            const card = document.getElementById(`card${index}`);
            if (card) {
                // Remove all grade classes
                card.className = 'subject-card';
                gradeSelect.className = '';
                
                if (grade) {
                    const gradeClass = `grade-${grade.replace('+', 'plus')}`;
                    card.classList.add(gradeClass);
                    gradeSelect.classList.add(gradeClass);
                }
            }
            
            localStorage.setItem("selectedGrades", JSON.stringify(selectedGrades));
            
            // Calculate GPA
            let total = 0, credits = 0, hasU = false;
            let arrearsList = [];
            
            subjects[sem].forEach((sub, i) => {
                const grade = selectedGrades[sem][i] || "";
                
                if (grade === "U") {
                    hasU = true;
                    arrearsList.push({name: sub.name, index: i});
                }
                
                if (grade && gradePoints[grade] !== undefined && sub.credits > 0) {
                    total += gradePoints[grade] * sub.credits;
                    credits += sub.credits;
                }
            });
            
            const gpa = (credits > 0) ? (total / credits).toFixed(2) : 0;
            gpaPerSem[sem] = {gpa: parseFloat(gpa), credits};
            localStorage.setItem("gpaPerSem", JSON.stringify(gpaPerSem));
            
            // Update GPA display
            const gpaResult = document.getElementById("gpaResult");
            const gpaValue = document.getElementById("gpaValue");
            const gpaProgress = document.getElementById("gpaProgress");
            
            gpaResult.style.display = "flex";
            gpaValue.textContent = gpa;
            gpaProgress.style.width = `${(gpa / 10) * 100}%`;
            
            // Set result card style based on GPA
            gpaResult.className = "result-card gpa-result";
            if (hasU) {
                gpaResult.classList.add("fail");
            }
            
            // Update arrears list
            updateArrears(arrearsList);
            
            // Update CGPA
            updateCGPA();
            loadCGPAInputs(); // Refresh CGPA inputs to show updated GPA
        }

        // Update arrears list display
        function updateArrears(arrearsList) {
            const arrearsContainer = document.getElementById("arrears");
            const arrearsListElement = document.getElementById("arrearsList");
            
            if (arrearsList.length > 0) {
                arrearsListElement.innerHTML = arrearsList.map(sub => 
                    `<li onclick="highlightCard(${sub.index})">
                        <span>${sub.name}</span>
                        <i class="fas fa-arrow-right"></i>
                    </li>`
                ).join("");
                
                arrearsContainer.classList.add("show");
            } else {
                arrearsContainer.classList.remove("show");
            }
        }

        // Toggle arrears visibility
        function toggleArrears() {
            const arrearsContainer = document.getElementById("arrears");
            arrearsContainer.classList.toggle("show");
        }

        // Highlight a specific card
        function highlightCard(index) {
            const cards = document.querySelectorAll(".subject-card");
            cards.forEach(c => c.style.boxShadow = "");
            
            const card = document.getElementById(`card${index}`);
            if (card) {
                card.style.boxShadow = "0 0 15px 5px rgba(255, 255, 0, 0.7)";
                card.scrollIntoView({behavior: "smooth", block: "center"});
                
                // Remove highlight after 3 seconds
                setTimeout(() => {
                    card.style.boxShadow = "";
                }, 3000);
            }
        }

        // Load CGPA inputs for all semesters
        function loadCGPAInputs() {
            const cgpaContainer = document.getElementById("cgpaContainer");
            let html = "";
            
            for (let sem = 1; sem <= 8; sem++) {
                const semData = gpaPerSem[sem] || {gpa: 0, credits: 0};
                const isAutoFetched = semData.gpa > 0 && semData.credits > 0;
                
                html += `
                    <div class="semester-input">
                        <label for="cgpaSem${sem}">Semester ${sem} GPA</label>
                        ${isAutoFetched ? 
                            `<div class="auto-fetch">
                                <i class="fas fa-check-circle"></i>
                                <span>Auto-fetched</span>
                            </div>` : ''
                        }
                        <input type="number" id="cgpaSem${sem}" min="0" max="10" step="0.01" 
                               value="${semData.gpa.toFixed(2)}" 
                               onchange="updateManualCGPA(${sem})" 
                               placeholder="0.00"
                               ${isAutoFetched ? 'readonly' : ''}>
                    </div>`;
            }
            
            cgpaContainer.innerHTML = html;
            updateCGPA();
        }

        // Update CGPA when manual inputs change
        function updateManualCGPA(sem) {
            const input = document.getElementById(`cgpaSem${sem}`);
            const value = parseFloat(input.value) || 0;
            
            // Get credits for this semester (use default if not available)
            const credits = subjects[sem] ? 
                subjects[sem].reduce((sum, sub) => sum + sub.credits, 0) : 
                20; // Default average credits
            
            gpaPerSem[sem] = {gpa: value, credits};
            localStorage.setItem("gpaPerSem", JSON.stringify(gpaPerSem));
            updateCGPA();
        }

        // Calculate and display CGPA
        function updateCGPA() {
            let totalWeightedGPA = 0, totalCredits = 0;
            let hasLow = false;
            
            for (const sem in gpaPerSem) {
                const data = gpaPerSem[sem];
                if (data.gpa > 0) {
                    totalWeightedGPA += data.gpa * data.credits;
                    totalCredits += data.credits;
                    if (data.gpa < 5) hasLow = true;
                }
            }
            
            const cgpaResult = document.getElementById("cgpaResult");
            const cgpaValue = document.getElementById("cgpaValue");
            const cgpaProgress = document.getElementById("cgpaProgress");
            
            if (totalCredits === 0) {
                cgpaValue.textContent = "0.00";
                cgpaProgress.style.width = "0%";
                return;
            }
            
            const cgpa = (totalWeightedGPA / totalCredits).toFixed(2);
            cgpaValue.textContent = cgpa;
            cgpaProgress.style.width = `${(cgpa / 10) * 100}%`;
            
            // Set result card style based on CGPA
            cgpaResult.className = "result-card cgpa-result";
            if (hasLow) {
                cgpaResult.classList.add("fail");
            } else if (cgpa >= 9) {
                cgpaResult.classList.add("high");
                createConfetti();
            }
        }

        // Create confetti effect
        function createConfetti() {
            if (parseFloat(document.getElementById("cgpaValue").textContent) < 9) return;
            
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
            
            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.width = `${Math.random() * 10 + 5}px`;
                confetti.style.height = `${Math.random() * 10 + 5}px`;
                confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
                
                document.body.appendChild(confetti);
                
                // Remove confetti after animation
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        // Reset calculator
        function resetCalculator() {
            if (confirm("Are you sure you want to reset all data?")) {
                selectedGrades = {};
                gpaPerSem = {};
                localStorage.removeItem("selectedGrades");
                localStorage.removeItem("gpaPerSem");
                localStorage.removeItem("lastSemester");
                
                document.getElementById("semester").value = "";
                document.getElementById("subjectForm").innerHTML = "";
                document.getElementById("gpaResult").style.display = "none";
                document.getElementById("arrears").classList.remove("show");
                
                loadCGPAInputs();
                updateCGPA();
                
                // Show notification
                alert("Calculator has been reset successfully!");
            }
        }

        // Initialize when page loads
        window.onload = init;
    </script>
</body>
</html>
